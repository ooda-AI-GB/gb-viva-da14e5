{% extends "base.html" %}

{% block content %}
    <h2>All Tasks</h2>

    <form action="/tasks" method="post">
        <h3>Add New Task</h3>
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" required>

        <label for="description">Description:</label>
        <textarea id="description" name="description"></textarea>

        <label for="priority">Priority:</label>
        <select id="priority" name="priority" required>
            <option value="High">High</option>
            <option value="Medium">Medium</option>
            <option value="Low">Low</option>
        </select>

        <label for="due_date">Due Date:</label>
        <input type="date" id="due_date" name="due_date" value="{{ date.strftime('%Y-%m-%d') }}" required>

        <button type="submit">Add Task</button>
    </form>

    {% if tasks %}
        <div class="task-list">
            {% for task in tasks %}
                <div class="task-card {% if task.priority == 'High' %}high-priority{% endif %} {% if task.completed %}completed{% endif %}">
                    <h3>{{ task.title }}</h3>
                    <p>{{ task.description }}</p>
                    <div class="task-meta">
                        Priority: <strong>{{ task.priority }}</strong> | Due: {{ task.due_date.strftime('%Y-%m-%d') }}
                    </div>
                    <div class="task-actions">
                        <form action="/tasks/{{ task.id }}/toggle" method="post" style="display: inline;">
                            <button type="submit" class="button primary">
                                {% if task.completed %}Mark Pending{% else %}Mark Complete{% endif %}
                            </button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No tasks found. Add one above!</p>
    {% endif %}
{% endblock %}